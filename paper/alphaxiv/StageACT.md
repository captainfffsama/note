# StageACT: 阶段条件模仿实现仿⼈机器⼈鲁棒开门

#具身智能 #manipulation #alphaXiv

[toc]

# 摘要

FieldAI 研究⼈员开发了 StageACT,⼀个阶段条件模仿学习框架,使优必选 G1 ⼈形机器⼈能够在真实的办公环境中⾃主开⻔,在未见过的门上实现了 55% 的成功率,是基线性能的两倍多。该框架展⽰了强⼤的故障恢复能⼒,并能够通过明确的阶段提⽰引导机器⼈⾏为。

# 1. 概述

StageACT 引⼊了⼀个阶段条件模仿学习框架,使⼈形机器⼈在真实世界的办公环境中⾃主开⻔。 这项研究解决了⼀个机器⼈学中的基本挑战: 使⼈形系统能够执⾏复杂的、⻓周期任务,这些任 务需要运动与操作之间紧密耦合,⽽⽆需依赖外部传感器或关于环境的特权信息。

![](../../Attachments/stageact_fig1.jpeg)

图 1: 完整的开⻔序列,展⽰了⼈形机器⼈⾃主执⾏所有五个阶段: 寻找⻔把⼿、接近⻔把⼿、旋转⻔把⼿、推开⻔,以及停在⼀个稳定的位置。

# 2. 问题与动机

开⻔是机器⼈学中⼀个典型的基准任务,它结合了多个具有挑战性的⽅⾯: 接触式操作、动态平 衡控制以及在部分可观察性下的推理。该任务本质上是⾮⻢尔可夫的,因为视觉上相似的观测可 能对应着完全不同的底层状态——例如,从机器⼈的⻆度来看,接近⻔把⼿和准备推开⻔可能看起 来相同,但需要截然不同的动作。

传统的模仿学习⽅法在这种任务上表现不佳,因为它们经常遭受 " 模式崩溃 ",即策略平均了来⾃不 同阶段的动作或以错误的顺序执⾏它们。这对于时间上下⽂对于正确动作选择⾄关重要的⻓周期 任务来说尤为成问题。之前的⼈形机器⼈开⻔演⽰主要依赖于远程操作或外部传感辅助 (如 AR 标 记),这限制了它们在⾮结构化环境中的适⽤性。

# 3. 技术⽅法

StageACT 框架建⽴在动作分块 Transformer (ACT) 架构之上,并通过明确的阶段条件扩展了它, 以为策略执⾏提供时间上下⽂。该⽅法由三个主要组件组成:

## 3.1. 数据收集系统

研究⼈员开发了⼀个复杂的全⾝远程操作系统,使⽤了配备 Dex-3 ⼿的宇树 G1 ⼈形机器⼈。远程 操作设置将控制分为 Apple Vision Pro 头戴式设备 (⽤于上半⾝操作) 和 Xbox 控制器 (⽤于运 动)。这种解耦⽅法显著减轻了操作员的负担,同时保持了操作和运动之间的有效协调。

![](../../Attachments/stageact_fig2.jpeg)

图: 全⾝远程操作系统,展⽰了从⼈类操作员输⼊到机器⼈动作的映射,结合了基于视觉的上半 ⾝控制和基于游戏⼿柄的运动指令

团队在两个不同的办公环境中收集了 135 次成功的开⻔演⽰,这些环境具有不同的照明条件和⻔ 动态。每个轨迹⻓ 20-30 秒,包括来⾃机器⼈头部摄像头的 RGB 图像观测以及上半⾝关节状态。

## 3.2. 阶段条件策略架构

核⼼创新在于通过明确的阶段信息增强 ACT 策略。开⻔任务被分解为五个不同的阶段:

1. 搜索 (S1): 定位⻔把⼿

2. 接近 (S2): 将左臂移向⻔把⼿

3. 旋转 (S3): 向下按并旋转⻔把⼿

4. 推动 (S4): ⽤右臂推开⻔

5. 停⽌ (S5): 返回到稳定的静⽌位置

![](../../Attachments/stageact_fig3.jpeg)

图:StageACT 架构,展⽰了阶段信息如何被编码为独热向量,并与视觉和本体感受观测相结合, 以条件化 ACT 策略

这些阶段被编码为独热向量,并与机器⼈的观测 (摄像头图像、关节状态和潜在变量) 拼接,作 为 Transformer 解码器的输⼊。阶段标签由⼈类专家在后处理阶段进⾏标注,他们同时使⽤了视觉 线索和本体感受信息 (如关节扭矩),这对于区分视觉上相似但功能上不同的阶段⾄关重要。

## 3.3. 训练与实现

该策略是使⽤条件变分⾃编码器 (CVAE) 框架训练的,其中编码器将机器⼈状态和演⽰动作映射 到⼀个潜在变量,⽽ Transformer 解码器根据当前观测和潜在变量⽣成未来的动作序列。阶段条件 作⽤提供了明确的时间上下⽂,有助于解决部分可观测状态下的歧义。

# 4. 关键发现

实验评估侧重于在⼀个以前从未⻅过的⻔上测试策略,该⻔的出现和动态与训练数据不同。结果 表明阶段条件作⽤具有明显的优势:

![](../../Attachments/stageact_fig4.jpeg)

图: 开⻔的五个阶段,以及每个阶段对应的机器⼈配置和动作

性能提升:StageACT 的成功率为 55%,⽽标准 ACT 为 20%,带有观测历史的 ACT 为 10%。阶段条 件策略也以更快的速度 (平均 20.7 秒) 完成任务,并具有更低的跟踪误差,这表明对演⽰⾏为的 执⾏更⾼效、更忠实。

关键阶段分析: 最显著的改进发⽣在 " 接近 " 阶段 (S2),在该阶段,接近和推动动作之间的视觉模 糊性导致基线策略失败。StageACT 在 19 次尝试中成功完成了该阶段 17 次,⽽ ACT 在 20 次尝试中仅 成功了 7 次。

![](../../Attachments/stageact_fig5.jpeg)

图: 阶段标注过程,展⽰了关节位置和扭矩等本体感受线索如何帮助消除视觉上相似阶段的歧义

恢复能⼒: ⼀个特别重要的发现是 StageACT 能够实现训练数据中不存在的恢复⾏为。当失败后给 出明确的阶段提⽰时,机器⼈可以返回到早期阶段并重试有问题的动作,展⽰了增强的鲁棒性和 适应性。

# 5. 意义与启示

这项⼯作对⼈形机器⼈和模仿学习做出了⼏项重要贡献。⾸先,它展⽰了第⼀个⽆需外部传感或 特权信息即可运⾏的⾃主⼈形开⻔系统,标志着机器⼈能够在⾮结构化⼈类环境中运⾏迈出了重 要⼀步。

![](../../Attachments/stageact_fig6.jpeg)

图:StageACT 与基线⽅法的⽐较,显⽰了成功执⾏ (A) 与失败模式 (B、C),其中基线策略表 现出模式崩溃和过早的动作执⾏

阶段条件⽅法为⻓周期任务中的部分可观测性提供了⼀种可推⼴的解决⽅案,解决了模仿学习中 的⼀个基本挑战。通过提供明确的时间上下⽂,该⽅法使策略能够消除视觉上相似状态的歧义, 并按正确的顺序执⾏动作,这在开⻔之外具有⼴泛的应⽤。

所⽰的恢复能⼒代表了实际部署的⼀个关键进展,在实际部署中,机器⼈必须处理意外情况和执 ⾏失败。通过阶段提⽰引导⾏为的能⼒还提供了⼀种分层控制形式,这对于适应训练期间未⻅过 的新颖场景可能很有价值。

展望未来,这项⼯作为更复杂的移动操作任务奠定了基础,并为构建⼈形机器⼈的⼤规模通⽤策 略指明了道路。阶段条件框架有可能利⽤视觉语⾔模型实现⾃动化,从⽽实现可扩展的数据收集 和学习,适⽤于更⼴泛的复杂⾏为。这项研究使⼈形机器⼈显著地更接近于在⼈类⽣活和⼯作的 复杂、动态环境中⾃主且可靠地运⾏。

# 6. 相关引⽤

#### 利⽤低成本硬件学习细粒度双⼿操作

本⽂介绍了动作分块 Transformer (ACT),这是⼀个核⼼的模仿学习框架,本⽂提出的 StageACT ⽅法正是明确构建在此基础之上。StageACT 通过引⼊阶段条件 (stage-conditioning) 扩展了 ACT,旨在解决开⻔任务中部分可观测性和⻓周期性的问题。

T. Z. Zhao, V. Kumar, S. Levine, and C. Finn, "Learning fine-grained bimanual manipulation with low-cost hardware," arXiv preprint arXiv:2304.13705, 2023.

#### DARPA 机器⼈挑战赛决赛: 结果与展望

这篇引⽤是基础性的,因为它⾃ 2015 年 DARPA 机器⼈挑战赛以来,便将开⻔确⽴为⼈形机器⼈的 ⼀项经典基准任务。它提供了历史背景和动机,解释了为何⾃主开⻔在该领域仍然是⼀个重要且 困难的问题。

E. Krotkov, D. Hackett, L. Jackel, M. Perschbacher, J. Pippine, J. Strauss, G. Pratt, and C. Orlowski, "The DARPA robotics challenge finals: Results and perspectives," in The DARPA robotics challenge finals: Humanoid robots to the rescue. Springer, 2018, pp. 1–26.

#### 基于分层模仿学习的多阶段电缆布线

本⽂被引作⼀个将⻓时程任务分解为特定阶段策略的层次框架的关键例⼦。它与 StageACT ⽅法形 成直接对⽐,后者使⽤⼀个基于阶段输⼊的单⼀通⽤策略,⽽⾮依赖多个专⻔化组件。

J. Luo, C. Xu, X. Geng, G. Feng, K. Fang, L. Tan, S. Schaal, and S. Levine, "Multistage cable routing through hierarchical imitation learning," IEEE Transactions on Robotics, vol. 40, pp. 1476–1491, 2024.

#### FALCON: 学习⼒⾃适应的⼈形移动操作

这项⼯作被引⽤为最近在遥操作环境下进⾏的类⼈机器⼈开⻔演⽰。它具有⾼度相关性,因为它 突出了主论⽂贡献的新颖之处,即在没有⼈类操作员的情况下实现了完全⾃主的开⻔。

Y. Zhang, Y. Yuan, P. Gurunath, T. He, S. Omidshafiei, A.-A. Agha-Mohammadi, M. Vazquez-Chanlatte, L. Pedersen, and G. Shi, "FALCON: Learning force-adaptive humanoid locomanipulation," arXiv preprint arXiv:2505.06776, 2025.